/**
 * Copyright (C) 2020 Giuseppe Eletto
 * "TicTacToe.js" is free software: you can redistribute it and/or modify 
 * it under the terms of the GNU Lesser General Public License v3 (or later).
 * More at https://github.com/giuseppe998e/tictactoe-js
 */"use strict";const TicTacToe=function(t){const e={},n=[[0,1,2],[0,3,6],[0,4,8],[1,4,7],[2,4,6],[2,5,8],[3,4,5],[6,7,8]],r={Human:-1,Blank:0,Computer:1},o=(()=>{if("string"!=typeof t||"#"!==t[0])throw"Board not found!";return document.querySelectorAll(`${t} .ttt-box`)})();let l=Array(9).fill(r.Blank),i=0,u=0,a=2,s=r.Human,c=null,m=null,f=null;const d=()=>{const t=w(),n=k();return!(!t&&!n)&&(t?(N()?(console.log('Player "Human" WINS!'),s=r.Human,i+=1):(console.log('Player "Computer" WINS!'),s=r.Computer,u+=1),"function"==typeof c&&c(s==r.Human?"Human":"Computer"),"function"==typeof f&&f(i,u)):n&&(console.log("DRAW!"),"function"==typeof m&&m()),setTimeout(()=>e.init(),350),!0)},p=()=>{if(!N()){let t=-1;switch(a){case 0:t=h();break;case 1:t=H();break;case 2:t=y()}g(t)&&!d()&&(s=r.Human)}},h=()=>{throw"To be implemented!"},H=()=>{throw"To be implemented!"},y=()=>{let t=-2,e=-1;for(let n=0;n<l.length;n++)if(B(n)){const o=l.slice();o[n]=r.Computer;const i=-b(o,r.Human);i>t&&(t=i,e=n)}return e},b=(t,e)=>{const n=C(t);if(!1!==n)return n*e;let r=-2,o=-1;for(let n=0;n<t.length;n++)if(B(n,t)){const l=t.slice();l[n]=e;const i=-b(l,T(e));i>r&&(r=i,o=n)}return-1==o?0:r},g=t=>{if(isNaN(t))throw`"${t}" is not a number!`;return!!B(t)&&(N()?(l[t]=r.Human,o[t].classList.add("human")):(l[t]=r.Computer,o[t].classList.add("computer")),!0)},k=(t=l)=>{for(let e=0;e<t.length;e++)if(B(e,t))return!1;return!0},w=(t=s,e=l)=>C(e)==t,C=(t=l)=>{for(let e=0;e<n.length;e++){const o=n[e],l=t[o[0]];if(l!=r.Blank&&t[o[1]]==l&&t[o[2]]==l)return l}return!1},B=(t,e=l)=>e[t]==r.Blank,N=()=>s==r.Human,T=(t=s)=>{if(1!==t&&-1!==t)throw`${t} is not a valid input!`;return-1*t};return e.init=(()=>{l=Array(9).fill(r.Blank),o.forEach(t=>t.classList.remove("human","computer")),N()||p()}),e.setDifficulty=(t=>{isNaN(t)&&console.error(`"${t}" is not a number!`),t>=0&&t<=2||console.error(`"${t}" is not between 0 and 2 (included)!`),a=t,e.init()}),e.setWinHandler=(t=>{c=t}),e.setDrawHandler=(t=>{m=t}),e.setPointsHandler=(t=>{f=t}),o.forEach((t,e)=>{t.addEventListener("click",()=>{N()&&g(e)&&!d()&&(s=r.Computer,p())},!1)}),e.init(),e};