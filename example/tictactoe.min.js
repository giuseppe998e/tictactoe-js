/**
 * Copyright (C) 2020 Giuseppe Eletto
 * "TicTacToe.js" is free software: you can redistribute it and/or modify 
 * it under the terms of the GNU Lesser General Public License v3 (or later).
 * More at https://github.com/giuseppe998e/tictactoe-js
 */"use strict";const TicTacToe=function(t){const e={},n=[[0,1,2],[0,3,6],[0,4,8],[1,4,7],[2,4,6],[2,5,8],[3,4,5],[6,7,8]],r=-1,o=0,i=1,l=(()=>{if("string"!=typeof t||"#"!==t[0])throw"Board not found!";return document.querySelectorAll(`${t} .ttt-box`)})();let s=Array(9).fill(o),c=0,u=0,a=2,f=r,d=null,m=null,h=null;const p=()=>{const t=A(),n=$();return!(!t&&!n)&&(t?(k()?(console.log('Player "Human" WINS!'),f=r,c+=1):(console.log('Player "Computer" WINS!'),f=i,u+=1),"function"==typeof d&&d(f==r?"Human":"Computer"),"function"==typeof h&&h(c,u)):n&&(console.log("DRAW!"),"function"==typeof m&&m()),setTimeout(()=>e.init(),350),!0)},y=()=>{if(!k()){let t=-1;switch(a){case 0:t=b();break;case 1:t=g();break;case 2:t=w()}H(t)&&!p()&&(f=r)}},b=()=>{throw"To be implemented!"},g=()=>{throw"To be implemented!"},w=()=>{let t=-1/0,e=-1;for(let n=0;n<s.length;n++)if(W(n)){const o=T(i,n),l=-N(o,r);t<l&&(t=l,e=n)}return e},N=(t,e)=>{const n=L(t);if(!1!==n)return n*e;let r=-1/0;for(let n=0;n<t.length;n++)if(W(n,t)){const o=T(e,n,t),i=-N(o,v(e));r=Math.max(r,i)}return isFinite(r)?r:0},T=(t,e,n=s)=>{const r=n.slice();return r[e]=t,r},H=t=>{if(isNaN(t))throw`"${t}" is not a number!`;return!!W(t)&&(k()?(s[t]=r,l[t].classList.add("human")):(s[t]=i,l[t].classList.add("computer")),!0)},$=(t=s)=>{for(let e=0;e<t.length;e++)if(W(e,t))return!1;return!0},A=(t=f,e=s)=>L(e)==t,L=(t=s)=>{for(let e=0;e<n.length;e++){const r=n[e],i=t[r[0]];if(i!=o&&t[r[1]]==i&&t[r[2]]==i)return i}return!1},W=(t,e=s)=>e[t]==o,k=()=>f==r,v=(t=f)=>{if(1!==t&&-1!==t)throw`${t} is not a valid input!`;return-1*t};return e.init=(()=>{s=Array(9).fill(o),l.forEach(t=>t.classList.remove("human","computer")),k()||y()}),e.setDifficulty=(t=>{isNaN(t)&&console.error(`"${t}" is not a number!`),t>=0&&t<=2||console.error(`"${t}" is not between 0 and 2 (included)!`),a=t,c=0,u=0,f=r,"function"==typeof h&&h(c,u),e.init()}),e.setWinHandler=(t=>{d=t}),e.setDrawHandler=(t=>{m=t}),e.setPointsHandler=(t=>{h=t}),l.forEach((t,e)=>{t.addEventListener("click",()=>{k()&&H(e)&&!p()&&(f=i,y())},!1)}),e.init(),e};